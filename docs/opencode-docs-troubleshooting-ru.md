# Устранение неполадок (Troubleshooting)

Распространенные проблемы и способы их решения.
Чтобы отладить любые проблемы с OpenCode, вы можете проверить логи или данные сессии, которые он хранит локально.

## Логи

Файлы логов записываются в:
*   macOS/Linux: `~/.local/share/opencode/log/`
*   Windows: `%USERPROFILE%\.local\share\opencode\log\`

Файлы логов именуются с использованием временных меток (например, `2025-01-09T123456.log`), и хранятся последние 10 файлов логов.

Вы можете установить уровень логирования с помощью опции командной строки `--log-level`, чтобы получить более подробную отладочную информацию. Например:

```bash
opencode --log-level DEBUG
```

## Хранилище (Storage)

`opencode` хранит данные сессии и другие данные приложения на диске в:
*   macOS/Linux: `~/.local/share/opencode/`
*   Windows: `%USERPROFILE%\.local\share\opencode`

Эта директория содержит:
*   `auth.json` - Данные аутентификации, такие как API ключи, токены OAuth
*   `log/` - Логи приложения
*   `project/` - Данные, специфичные для проекта, такие как сессии и сообщения

Если проект находится внутри Git репозитория, данные хранятся в `./<project-slug>/storage/`.
Если это не Git репозиторий, они хранятся в `./global/storage/`.

## Получение помощи

Если вы испытываете проблемы с OpenCode:

1.  **Сообщайте о проблемах на GitHub**
    Лучший способ сообщить об ошибках или запросить функции - через наш репозиторий GitHub:
    [github.com/anomalyco/opencode/issues](https://github.com/anomalyco/opencode/issues)
    Перед созданием новой проблемы выполните поиск по существующим, чтобы убедиться, что о вашей проблеме уже не сообщили.

2.  **Присоединяйтесь к нашему Discord**
    Для получения помощи в реальном времени и обсуждения с сообществом, присоединяйтесь к нашему серверу Discord:
    [opencode.ai/discord](https://opencode.ai/discord)

## Распространенные проблемы

Вот некоторые распространенные проблемы и способы их решения.

### OpenCode не запускается

1.  Проверьте логи на наличие сообщений об ошибках.
2.  Попробуйте запустить с `--print-logs`, чтобы увидеть вывод в терминале.
3.  Убедитесь, что у вас установлена последняя версия с помощью `opencode upgrade`.

### Проблемы с аутентификацией

1.  Попробуйте повторно аутентифицироваться с помощью команды `/connect` в TUI.
2.  Проверьте, что ваши API ключи действительны.
3.  Убедитесь, что ваша сеть разрешает соединения с API провайдера.

### Модель недоступна

1.  Проверьте, что вы аутентифицированы у провайдера.
2.  Убедитесь, что имя модели в вашем конфиге правильное.
3.  Некоторые модели могут требовать специального доступа или подписки.

Если вы столкнулись с `ProviderModelNotFoundError`, вы, скорее всего, неправильно ссылаетесь на модель где-то. На модели следует ссылаться так: `<providerId>/<modelId>`

Примеры:
*   `openai/gpt-4.1`
*   `openrouter/google/gemini-2.5-flash`
*   `opencode/kimi-k2`

Чтобы узнать, к каким моделям у вас есть доступ, запустите `opencode models`.

### ProviderInitError

Если вы столкнулись с `ProviderInitError`, у вас, вероятно, неверная или поврежденная конфигурация.

Чтобы решить это:
1.  Сначала убедитесь, что ваш провайдер настроен правильно, следуя [руководству по провайдерам](opencode-docs-providers-ru.md).
2.  Если проблема сохраняется, попробуйте очистить сохраненную конфигурацию:

    ```bash
    rm -rf ~/.local/share/opencode
    ```

3.  Повторно аутентифицируйтесь с вашим провайдером, используя команду `/connect` в TUI.

### AI_APICallError и проблемы с пакетами провайдеров

Если вы сталкиваетесь с ошибками вызова API, это может быть связано с устаревшими пакетами провайдеров. `opencode` динамически устанавливает пакеты провайдеров (OpenAI, Anthropic, Google и т.д.) по мере необходимости и кэширует их локально.

Чтобы решить проблемы с пакетами провайдеров:

1.  Очистите кэш пакетов провайдеров:

    ```bash
    rm -rf ~/.cache/opencode
    ```

2.  Перезапустите `opencode`, чтобы переустановить последние пакеты провайдеров.

Это заставит `opencode` загрузить самые последние версии пакетов провайдеров, что часто решает проблемы совместимости с параметрами моделей и изменениями API.

### Копирование/вставка не работает на Linux

Пользователи Linux должны установить одну из следующих утилит буфера обмена для работы функции копирования/вставки:

Для систем **X11**:
```bash
apt install -y xclip
# или
apt install -y xsel
```

Для систем **Wayland**:
```bash
apt install -y wl-clipboard
```

Для **headless** окружений:
```bash
apt install -y xvfb
# и запустите:
Xvfb :99 -screen 0 1024x768x24 > /dev/null 2>&1 &
export DISPLAY=:99.0
```

`opencode` определит, используете ли вы Wayland, и предпочтет `wl-clipboard`, в противном случае он попытается найти инструменты буфера обмена в порядке: `xclip` и `xsel`.
